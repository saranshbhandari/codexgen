private static String resolveDbVendor(DataEndpointSettings ep) {
    if (ep == null) return null;
    try {
        if (ep.getDatabasesettings() == null) return null;
        String t = ep.getDatabasesettings().getDatabaseType(); // adjust getter name if different
        return (t == null) ? null : t.trim().toUpperCase(Locale.ROOT);
    } catch (Exception ignored) {
        return null;
    }
}
  final String srcVendor  = resolveDbVendor(settings.getSource());
    final String destVendor = resolveDbVendor(settings.getDestination());
    final ConversionPlan conversionPlan =
            DataConverter.prepareConversionPlan(settings.getMappings(), srcVendor, destVendor);


   DataConverter.convertBatchInPlace(batch, conversionPlan);
